# Week 3-4 è¿›åº¦æŠ¥å‘Š

> **å¼€å§‹æ—¥æœŸ**: 2025-10-26
> **å½“å‰é˜¶æ®µ**: Week 3-4 AI èƒ½åŠ›å¼€å‘
> **æ•´ä½“è¿›åº¦**: 25% (1/4 æ ¸å¿ƒä»»åŠ¡å·²å®Œæˆ)

---

## âœ… å·²å®Œæˆ (1/4)

### 1. **RAG Engine** - 100% âœ… (åˆšåˆšå®Œæˆï¼)

æ£€ç´¢å¢å¼ºç”Ÿæˆå¼•æ“ - å®Œæ•´å®ç°

#### æ ¸å¿ƒåŠŸèƒ½

##### 1. æŸ¥è¯¢æ”¹å†™ï¼ˆQueryRewriterï¼‰

- âœ… åŸºäºå¯¹è¯å†å²çš„æŸ¥è¯¢æ”¹å†™
- âœ… æ¶ˆæ­§ä¹‰åŒ–
- âœ… ä¸Šä¸‹æ–‡èåˆ
- âœ… å¤šæŸ¥è¯¢ç”Ÿæˆï¼ˆMulti-Queryï¼‰

##### 2. æ£€ç´¢é›†æˆï¼ˆRetrievalClientï¼‰

- âœ… è°ƒç”¨ Retrieval Service
- âœ… æ”¯æŒå¤šç§æ£€ç´¢æ¨¡å¼
- âœ… ç§Ÿæˆ·éš”ç¦»
- âœ… HTTP å®¢æˆ·ç«¯

##### 3. ä¸Šä¸‹æ–‡æ„å»ºï¼ˆContextBuilderï¼‰

- âœ… æ–‡æ¡£å»é‡
- âœ… ç›¸å…³æ€§æ’åº
- âœ… ä¸Šä¸‹æ–‡æˆªæ–­ï¼ˆæœ€å¤§ 4000 å­—ç¬¦ï¼‰
- âœ… æ ¼å¼åŒ–è¾“å‡º

##### 4. Prompt ç”Ÿæˆï¼ˆPromptGeneratorï¼‰

- âœ… Simple æ¨¡å¼ï¼ˆç®€å•é—®ç­”ï¼‰
- âœ… Advanced æ¨¡å¼ï¼ˆå¤æ‚æ¨ç†ï¼‰
- âœ… Precise æ¨¡å¼ï¼ˆç²¾ç¡®å¼•ç”¨ï¼‰
- âœ… è‡ªå®šä¹‰æ¨¡æ¿æ”¯æŒ

##### 5. LLM é›†æˆï¼ˆLLMClientï¼‰

- âœ… OpenAI æ”¯æŒ
- âœ… Anthropic æ”¯æŒ
- âœ… Azure OpenAI æ”¯æŒ
- âœ… æµå¼ç”Ÿæˆ
- âœ… éæµå¼ç”Ÿæˆ

##### 6. ç­”æ¡ˆç”Ÿæˆ

- âœ… æµå¼å“åº”ï¼ˆSSEï¼‰
- âœ… éæµå¼å“åº”
- âœ… å¼•ç”¨æ¥æºæå–
- âœ… ç»Ÿè®¡ä¿¡æ¯

#### æ–‡ä»¶æ¸…å•ï¼ˆ9 ä¸ªæ–‡ä»¶ï¼Œ~1,800 è¡Œä»£ç ï¼‰

```
algo/rag-engine/
â”œâ”€â”€ main.py                                   # FastAPI ä¸»ç¨‹åº (~200 è¡Œ)
â”œâ”€â”€ requirements.txt                           # ä¾èµ–æ¸…å•
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ rag_engine.py                     # æ ¸å¿ƒå¼•æ“ (~350 è¡Œ)
â”‚   â”‚   â”œâ”€â”€ query_rewriter.py                 # æŸ¥è¯¢æ”¹å†™ (~200 è¡Œ)
â”‚   â”‚   â”œâ”€â”€ context_builder.py                # ä¸Šä¸‹æ–‡æ„å»º (~180 è¡Œ)
â”‚   â”‚   â””â”€â”€ prompt_generator.py               # Prompt ç”Ÿæˆ (~100 è¡Œ)
â”‚   â””â”€â”€ infrastructure/
â”‚       â”œâ”€â”€ llm_client.py                     # LLM å®¢æˆ·ç«¯ (~250 è¡Œ)
â”‚       â””â”€â”€ retrieval_client.py               # æ£€ç´¢å®¢æˆ·ç«¯ (~100 è¡Œ)
```

#### API æ¥å£

##### POST /generateï¼ˆéæµå¼ï¼‰

```json
{
  "query": "ä»€ä¹ˆæ˜¯ GraphRAGï¼Ÿ",
  "conversation_id": "conv_123",
  "tenant_id": "tenant_456",
  "mode": "advanced",
  "top_k": 5,
  "temperature": 0.7,
  "include_sources": true
}
```

**å“åº”**:

```json
{
  "answer": "GraphRAGï¼ˆå›¾æ£€ç´¢å¢å¼ºç”Ÿæˆï¼‰æ˜¯...",
  "sources": [
    {
      "document_id": "doc_1",
      "chunk_id": "chunk_1_0",
      "content": "...",
      "score": 0.95
    }
  ],
  "query": "ä»€ä¹ˆæ˜¯ GraphRAGï¼Ÿ",
  "rewritten_query": "è¯·è§£é‡Š GraphRAG æŠ€æœ¯çš„å®šä¹‰ã€åŸç†å’Œåº”ç”¨",
  "retrieved_count": 5,
  "generation_time": 2.35,
  "mode": "advanced"
}
```

##### POST /generate/streamï¼ˆæµå¼ï¼‰

è¿”å› SSE æµï¼š

```
data: {"type":"rewritten_query","content":"..."}
data: {"type":"retrieved_count","content":5}
data: {"type":"answer_chunk","content":"Graph"}
data: {"type":"answer_chunk","content":"RAG"}
data: {"type":"sources","content":[...]}
data: {"type":"done","generation_time":2.35}
```

##### POST /rewriteï¼ˆæŸ¥è¯¢æ”¹å†™æµ‹è¯•ï¼‰

```json
{
  "query": "å®ƒçš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ",
  "conversation_history": [
    { "role": "user", "content": "ä»€ä¹ˆæ˜¯ GraphRAGï¼Ÿ" },
    { "role": "assistant", "content": "GraphRAG æ˜¯..." }
  ]
}
```

#### æŠ€æœ¯äº®ç‚¹

1. **æ™ºèƒ½æŸ¥è¯¢æ”¹å†™**

   - èåˆå¯¹è¯å†å²
   - æ¶ˆé™¤æŒ‡ä»£æ­§ä¹‰
   - ç‹¬ç«‹æŸ¥è¯¢ç”Ÿæˆ

2. **å¤šæ¨¡å¼ Prompt**

   - Simple: å¿«é€Ÿé—®ç­”
   - Advanced: æ·±åº¦æ¨ç†
   - Precise: ç²¾ç¡®å¼•ç”¨

3. **å¤š LLM æ”¯æŒ**

   - OpenAIï¼ˆGPT-4/GPT-3.5ï¼‰
   - Anthropicï¼ˆClaudeï¼‰
   - Azure OpenAI
   - ç»Ÿä¸€æ¥å£

4. **æµå¼ç”Ÿæˆ**

   - SSE æµå¼å“åº”
   - å®æ—¶è¾“å‡º
   - ä½å»¶è¿Ÿä½“éªŒ

5. **æ¥æºè¿½è¸ª**
   - è‡ªåŠ¨æå–å¼•ç”¨
   - æ–‡æ¡£çº§æº¯æº
   - ç›¸å…³æ€§åˆ†æ•°

---

## â³ è¿›è¡Œä¸­ (1/4)

### 2. **Agent Engine** - 0% ğŸš§ï¼ˆå³å°†å¼€å§‹ï¼‰

LangGraph å·¥ä½œæµå¼•æ“

**ä»»åŠ¡æ¸…å•**:

- [ ] LangGraph å·¥ä½œæµå¼•æ“
- [ ] å·¥å…·æ³¨å†Œè¡¨
- [ ] ReAct æ¨¡å¼å®ç°
- [ ] å·¥å…·è°ƒç”¨ç³»ç»Ÿ
- [ ] è®°å¿†ç®¡ç†
- [ ] Plan-Execute æ¨¡å¼

**é¢„è®¡å·¥æ—¶**: 6 å¤©

---

## â³ å¾…å¼€å§‹ (2/4)

### 3. **Voice Engine** - 0%

è¯­éŸ³å¤„ç†å¼•æ“

**ä»»åŠ¡æ¸…å•**:

- [ ] ASRï¼ˆWhisperï¼‰
- [ ] TTSï¼ˆEdge-TTSï¼‰
- [ ] VADï¼ˆSilero-VADï¼‰
- [ ] éŸ³é¢‘é¢„å¤„ç†
- [ ] æµå¼éŸ³é¢‘å¤„ç†

**é¢„è®¡å·¥æ—¶**: 4 å¤©

### 4. **Model Router** - 0%

æ¨¡å‹è·¯ç”±ä¸è´Ÿè½½å‡è¡¡

**ä»»åŠ¡æ¸…å•**:

- [ ] æ¨¡å‹è·¯ç”±ç­–ç•¥
- [ ] è´Ÿè½½å‡è¡¡
- [ ] é™çº§ç­–ç•¥
- [ ] æˆæœ¬ä¼˜åŒ–
- [ ] é€Ÿç‡é™åˆ¶

**é¢„è®¡å·¥æ—¶**: 3 å¤©

---

## ğŸ“Š ç»Ÿè®¡æ•°æ®

### å®Œæˆåº¦

| ä»»åŠ¡             | é¢„è®¡å·¥æ—¶  | å®é™…å·¥æ—¶   | çŠ¶æ€            | å®Œæˆåº¦  |
| ---------------- | --------- | ---------- | --------------- | ------- |
| **RAG Engine**   | 5 å¤©      | 0.3 å¤©     | âœ… å®Œæˆ         | 100%    |
| **Agent Engine** | 6 å¤©      | -          | ğŸš§ è¿›è¡Œä¸­       | 0%      |
| **Voice Engine** | 4 å¤©      | -          | â³ å¾…å¼€å§‹       | 0%      |
| **Model Router** | 3 å¤©      | -          | â³ å¾…å¼€å§‹       | 0%      |
| **æ€»è®¡**         | **18 å¤©** | **0.3 å¤©** | ğŸ‰ **25% å®Œæˆ** | **25%** |

### ä»£ç ç»Ÿè®¡

| æœåŠ¡           | æ–°å¢è¡Œæ•°      | æ–‡ä»¶æ•°       |
| -------------- | ------------- | ------------ |
| **RAG Engine** | ~1,800 è¡Œ     | 9 ä¸ªæ–‡ä»¶     |
| **æ€»è®¡**       | **~1,800 è¡Œ** | **9 ä¸ªæ–‡ä»¶** |

---

## ğŸ¯ RAG Engine å®Œæ•´æµç¨‹

```
ç”¨æˆ·æŸ¥è¯¢
    â†“
æŸ¥è¯¢æ”¹å†™ï¼ˆåŸºäºå¯¹è¯å†å²ï¼‰
    â†“
è°ƒç”¨ Retrieval Service
    â”œâ”€ å‘é‡æ£€ç´¢
    â”œâ”€ BM25 æ£€ç´¢
    â”œâ”€ RRF èåˆ
    â””â”€ Cross-Encoder é‡æ’åº
    â†“
ä¸Šä¸‹æ–‡æ„å»º
    â”œâ”€ å»é‡
    â”œâ”€ æ’åº
    â”œâ”€ æˆªæ–­
    â””â”€ æ ¼å¼åŒ–
    â†“
Prompt ç”Ÿæˆï¼ˆæ ¹æ®æ¨¡å¼ï¼‰
    â†“
LLM ç”Ÿæˆç­”æ¡ˆ
    â”œâ”€ æµå¼è¾“å‡º
    â””â”€ éæµå¼è¾“å‡º
    â†“
æå–å¼•ç”¨æ¥æº
    â†“
è¿”å›ç»“æœ
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

### ç«‹å³å¯åŠ¨

**Agent Engine**ï¼ˆé¢„è®¡ 6 å¤©ï¼‰

- LangGraph å·¥ä½œæµ
- å·¥å…·æ³¨å†Œè¡¨
- ReAct æ¨¡å¼
- å·¥å…·è°ƒç”¨
- è®°å¿†ç®¡ç†

### Week 3 è®¡åˆ’

1. âœ… **RAG Engine**ï¼ˆå·²å®Œæˆï¼‰
2. ğŸš§ **Agent Engine**ï¼ˆè¿›è¡Œä¸­ï¼‰
3. â³ **Voice Engine**
4. â³ **Model Router**

---

## ğŸ’¡ ç»éªŒæ€»ç»“

### RAG Engine å…³é”®è®¾è®¡

1. **æ¨¡å—åŒ–è®¾è®¡**

   - QueryRewriter
   - ContextBuilder
   - PromptGenerator
   - LLMClient
   - æ¯ä¸ªç»„ä»¶ç‹¬ç«‹å¯æµ‹è¯•

2. **å¤šæ¨¡å¼æ”¯æŒ**

   - Simple/Advanced/Precise
   - é€‚åº”ä¸åŒåœºæ™¯éœ€æ±‚

3. **æµå¼ä¼˜åŒ–**

   - SSE æµå¼å“åº”
   - å®æ—¶ç”¨æˆ·ä½“éªŒ

4. **å¤š LLM æ”¯æŒ**
   - ç»Ÿä¸€æ¥å£
   - æ˜“äºæ‰©å±•

---

**ç”Ÿæˆæ—¶é—´**: 2025-10-26
**çŠ¶æ€**: ğŸ‰ RAG Engine å®Œæˆï¼æ­£åœ¨å¼€å‘ Agent Engine...
